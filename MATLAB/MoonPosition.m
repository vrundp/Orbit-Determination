function r_moon_GCRF = MoonPosition(Params)

    %Params = UpdateParams(JD_UTC, Params);

    T_TDB = Params.T_TDB;
    %T_TDB = Params.T_UT1;

    lambda_ecl_moon = mod(Params.deg2rad * (218.32 + 481267.8813 * T_TDB ...
                      + 6.29 * sind(134.9 + 477198.85 * T_TDB) ...
                      - 1.27 * sind(259.2 - 413335.38 * T_TDB) ...
                      + 0.66 * sind(235.7 + 890534.23 * T_TDB) ...
                      + 0.21 * sind(269.9 + 954397.70 * T_TDB) ...
                      - 0.19 * sind(357.5 + 35999.05 * T_TDB) ...
                      - 0.11 * sind(186.6 + 966404.05 * T_TDB)), 2*pi);

    phi_ecl_moon = mod(Params.deg2rad * (5.13 * sind(93.3 + 483202.03 * T_TDB) ...
                   + 0.28 * sind(228.2 + 960400.87 * T_TDB) ...
                   - 0.28 * sind(318.3 + 6003.18 * T_TDB) ...
                   - 0.17 * sind(217.6 - 407332.20 * T_TDB)), 2*pi);

    p = mod(Params.deg2rad * (0.9508 + 0.0518 * cosd(134.9 + 477198.85 * T_TDB) ...
                        + 0.0095 * cosd(259.2 - 413335.38 * T_TDB) ...
                        + 0.0078 * cosd(235.7 + 890534.23 * T_TDB) ...
                        + 0.0028 * cosd(269.9 + 954397.70 * T_TDB)), 2*pi);

    eps_bar = mod(Params.deg2rad * (23.439291 - 0.0130042 * T_TDB - 1.64e-7 * T_TDB^2 + 5.04e-7 * T_TDB^3), 2*pi);

    r_moon = Params.R_earth / sin(p);

    r_moon_MOD = r_moon .* [cos(phi_ecl_moon) * cos(lambda_ecl_moon); ...
                            cos(eps_bar) * cos(phi_ecl_moon) * sin(lambda_ecl_moon) - sin(eps_bar) * sin(phi_ecl_moon); ...
                            sin(eps_bar) * cos(phi_ecl_moon) * sin(lambda_ecl_moon) + cos(eps_bar) * sin(phi_ecl_moon)];

    P = PrecessionMatrix(Params);

    r_moon_GCRF = P * r_moon_MOD;

end